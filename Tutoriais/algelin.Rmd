---
title: "Básico de Álgebra Linear"
author: "Guilherme Garcia"
date: "09 de Maio de 2017"
output:
  html_document:
    code_folding: show
    highlight: pygments
    number_sections: false
    toc: true
    theme: yeti
    toc_depth: 3
    toc_float: 
      collapsed: false
      smooth_scroll: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

<style>
@import url('https://fonts.googleapis.com/css?family=Crimson+Text|Overpass+Mono:400|Lora:700');

code.r{
	font-family: "Overpass Mono";
	font-size: 10pt;
}

body{
	font-family: 'Crimson Text';
	font-size: 16pt;
}

h1,h2,h3,h4{
	font-family: 'Lora';
}

h5,h6{
 	font-family: 'Crimson Text';
}
</style>

<script type="text/x-mathjax-config">
   MathJax.Hub.Config({  "HTML-CSS": { minScaleAdjust: 100, availableFonts: [] }  });
</script>

# Objetivos

O objetivo deste tutorial é introduzir alguns conceitos básicos de álgebra linear.
Esta disciplina possui um número muito grande de aplicações, que vão da computação gráfica até a previsão do tempo.
No contexto deste curso, alguns conceitos centrais em genética quantitativa são expressos através de vetores e matrizes, os objetos centrais desta introdução.

# Vetores

Existem três concepções básicas a respeito do que são vetores. 
Talvez, a concepção mais próxima de nós biólogos é a de um vetor como uma coleção de valores numéricos. 
Imagine que você toma algumas medidas lineares de uma coleção de organismos: a largura da cabeça, o comprimento da cabeça e o comprimento da cauda, por exemplo.
Para cada indivíduo de sua amostra, você tem uma coleção de três valores, e é razoável pensar que cada indivíduo é representado por uma concatenação destes três valores,
$$
\vec{a} = (x, y, z); \quad \vec{b} = (x', y', z') ... 
$$
em que $\vec{a}$ e $\vec{b}$ se referem a dois indivíduos distintos na amostra.
Claro que não precisamos nos ater a apenas três mensurações, de modo que esse vetor pode representar quantas medidas gostaríamos de tomar, mas é melhor manter as ideias em dimensionalidade baixa, por enquanto.

Uma outra representação para vetores, talvez mais próxima da realidade dos físicos é imaginar um vetor como uma seta. 
Para eles, várias quantidades de interesse são naturalmente representadas como vetores, como por exemplo a velocidade de uma partícula em uma trajetória ou o campo gravitacional da Terra.
Cada valor na concatenação acima pode ser concebido como a coordenada deste vetor em um eixo, e podemos representar graficamente cada vetor como uma seta que sai da origem destas coordenadas.
Por exemplo, os vetores
$$
\vec{u} = (0, -4); \quad \vec{v} = (2, 2); \quad \vec{w} = (-1, 3)
$$
podem ser representados graficamente no R usando o seguinte código:
```{r draw_vector, fig.asp = 1}
### definindo alguns vetores
u <- c(0, -4)
v <- c(2, 2)
w <- c(-1, 3)

### essa pequena função facilita bastante representar vetores na janela gráfica
plotVector <- function(v, color = 'black', width = 1)
    arrows(x0 = 0, y0 = 0, x1 = v[1], y1 = v[2],
           col = color, lwd = width, angle = 10)

### vamos apenas inicializar uma região gráfica vazia;
### xlim e ylim se referem aos limites desta janela;
### xlab e ylab são os nomes de cada eixo (nada, no caso).
plot(NA, xlim = c(-5, 5), ylim = c(-5, 5), xlab = '', ylab = '', asp = 1)

### vamos também desenhar linhas que representam os eixos de coordenadas
abline(h = 0, col = 'grey')
abline(v = 0, col = 'grey')

### agora, podemos usar a função que desenha vetores
plotVector(u, 'darkgreen')
plotVector(v, 'blue')
plotVector(w, 'red')
```


**Importante**: Idealmente, para todo código neste tutorial, seria bom você colá-lo em um *script* no RStudio e executá-lo mudando algumas coisas só para ver o que acontece.
No caso deste código acima, você pode plotar outros vetores, por exemplo, ou talvez mudar as cores.
Em alguns casos isso será estimulado através de uma ou mais perguntas, mas a sua curiosidade é fundamental na tarefa de se apropriar dos conceitos explorados aqui.
Por exemplo, você não fica tentado a descobrir o que o parâmetro *asp* faz na chamada da função plot?

Uma terceira concepção é mais próxima da realidade dos matemáticos, que em geral pensam as coisas na forma de conjuntos, as operações que podemos fazer com elementos neste conjunto, e as propriedades destas operações.
Nesta concepção, a representação mais adequada para um vetor é aquela que facilita sua compreensão do que está acontecendo.
No entanto, é importante notar que, qualquer que seja a operação feita com um vetor ou vetores, haverá duas formas de imaginar esta operação: uma relacionada a representá-los sob a forma de listas de números, outra relacionada a representá-los como setas.

Inicialmente, podemos fazer duas coisas com vetores: somá-los e multiplicá-los por números.
Para somar dois vetores, a forma mais simples de pensar a princípio é simplesmente somando suas entradas correspondentes individualmente:
$$
\vec{u} = (u_1, u_2); \vec{v} = (v_1, v_2) 
\Rightarrow \vec{u} + \vec{v} = (u_1 + v_1, u_2 + v_2)
$$
Além disso, podemos pensar nesta soma como uma concatenação de ações.
Neste código, mostramos que a soma de dois vetores, quando representados sob a forma de setas, corresponde a andar na direção e distância dada pelo primeiro vetor, depois andar a direção e distância dada pelo segundo vetor.

```{r vector_sum, fig.asp = 1}
u <- c(2, 1)
v <- c(0, 3)

### esta função desenha um vetor a partir da ponta de outro vetor
plotDislocatedVector <- function(u, v, color = 'black', width = 1)
    arrows(x0 = u[1], y0 = u[2], x1 = u[1] + v[1], y1 = u[2] + v[2],
           col = color, lwd = width, angle = 10)

### novamente, vamos inicializar um gráfico vazio
plot(NA, xlim = c(-5, 5), ylim = c(-5, 5), xlab = '', ylab = '', asp = 1)

abline(h = 0, col = 'grey')
abline(v = 0, col = 'grey')

plotVector(u, 'blue')
plotDislocatedVector(u, v, 'red')
plotVector(u + v, 'purple', width = 2)
```

Multiplicar um vetor por um número é também bastante direto, basta apenas multiplicar suas entradas individuais pelo número:
$$
\vec{u} = (u_1, u_2) \Rightarrow \alpha \cdot \vec{u} = (\alpha \cdot u_1, \alpha \cdot u_2)
$$
Neste contexto, chamamos de *escalar* este valor $\alpha$ que multiplica o vetor $\vec{u}$.

### Exercício 1
Tente modificar os pedaços de código utilizados anteriormente para representar graficamente o produto entre vetores e escalares. Depois, responda as seguintes perguntas:

1. O que acontece com um vetor após esta operação?

2. O que acontece se você multiplicar um vetor por um número negativo?

## Norma e Direção

Podemos caracterizar um vetor por sua **norma**, ou seja, o comprimento da seta que representa o vetor, e por sua **direção**, ou seja, para onde o vetor aponta.
A norma de um vetor pode ser calculada em duas dimensões pela relação de Pitágoras:
$$
\|\vec{u}\| = \sqrt{u_1^2 + u_2^2} 
$$
mas, independente do número de dimensões representadas no vetor, a norma de um vetor é obtida como sendo a raiz quadrada da soma de todas as coordenadas ao quadrado.

Uma operação que fazemos comumente é *normalizar* um vetor, isto é, dividir os elementos do vetor por sua norma, de modo que a norma deste novo vetor será unitária.

### Exercício 2
Leia atentamente e execute o código a seguir:

```{r circle_sample, eval = FALSE}
require(evolqg)

### o pacote evolqg possui uma função que normaliza um vetor
?Normalize

### vamos gerar alguns vetores aleatórios em duas dimensões

### primeiro, vamos gerar alguns números advindos de uma distribuição normal padrão
rand.vec <- rnorm(100)

### agora, vamos organizar esses números como vetores em uma tabela
rand.vec <- matrix(rand.vec, nrow = 50, ncol = 2)

### cada vetor aleatório corresponde a uma linha desta tabela
### quero normalizar cada vetor, utilizando a função aaply
norm.vec <- aaply(rand.vec, 1, Normalize)

### agora, vamos plotar estes vetores
### aqui, não vou me preocupar em representá-los como setas
### apenas o ponto no plot entre suas coordenadas é suficiente
plot(norm.vec, asp = 1, pch = 20)
```

1. Os pontos parecem desenhar uma forma em particular? Que forma é essa?

2. Aumente o número de vetores gerados para mil.

3. Você consegue elaborar uma razão para esta forma estar sendo gerada?

# Matrizes

- Matrizes como transformações lineares

# Autovetores e Autovalores
